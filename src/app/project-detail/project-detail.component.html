<app-layout>
  <div class="project-detail-container">
    <!-- En-tête du projet -->
    <div class="project-header">
      <div *ngIf="isLoading" class="loading-spinner">
        <div class="spinner"></div>
        <p>Chargement...</p>
      </div>
      
      <div *ngIf="error" class="error-message">{{ error }}</div>
      
      <div *ngIf="project && !isLoading" class="project-info">
        <div class="title-section">
          <h1>{{ project.name }}</h1>
          <div class="project-dates">
            <span>{{ project.startDate | date:'dd/MM/yyyy' }}</span> - <span>{{ project.endDate | date:'dd/MM/yyyy' }}</span>
          </div>
        </div>
        <p class="project-description">{{ project.description }}</p>
        <div class="project-creator">
          <strong>Créé par:</strong> {{ project.creatorUsername }}
        </div>
      </div>
    </div>
    
    <!-- Conteneur des tâches -->
    <div class="tasks-section">
      <div class="section-header">
        <h2>Tâches du projet</h2>
        <button class="add-task-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path>
          </svg>
          Nouvelle Tâche
        </button>
      </div>
      
      <div *ngIf="isLoading" class="loading-spinner">
        <div class="spinner"></div>
        <p>Chargement des tâches...</p>
      </div>
      
      <div *ngIf="tasks.length === 0 && !isLoading" class="no-tasks">
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24">
          <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"></path>
        </svg>
        <p>Aucune tâche trouvée. Commencez par créer une nouvelle tâche.</p>
      </div>
      
      <div *ngIf="tasks.length > 0" class="tasks-container">
        <div class="task-card" *ngFor="let task of tasks" [ngStyle]="{'border-left-color': task.color || '#4a6cf7'}">
          <div class="task-header">
            <h3>{{ task.title }}</h3>
            <div class="task-badges">
              <span class="status-badge" [ngClass]="getStatusClass(task.status)">
                {{ task.status === 'TODO' ? 'À faire' : 
                   task.status === 'IN_PROGRESS' ? 'En cours' :  'Terminé' }}
              </span>
              <span class="priority-badge" [ngClass]="getPriorityClass(task.priority)">
                {{ task.priority === 'LOW' ? 'Basse' : 
                   task.priority === 'MEDIUM' ? 'Moyenne' :
                   task.priority === 'HIGH' ? 'Haute' : 'Urgente' }}
              </span>
            </div>
          </div>
          
          <p class="task-description">{{ task.description }}</p>
          
          <div class="task-footer">
            <div class="task-assignee" *ngIf="task.assignee">
              <span class="avatar">{{ task.assignee.username.charAt(0) }}</span>
              <span>{{ task.assignee.username }}</span>
            </div>
            <div class="task-deadline" *ngIf="task.deadline">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24">
                <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8-8-3.59 8-8-8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"></path>
              </svg>
              <span>{{ task.deadline | date:'dd/MM/yyyy' }}</span>
            </div>
            <div class="task-points" *ngIf="task.storyPoints">
              <span>{{ task.storyPoints }} pts</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</app-layout>
